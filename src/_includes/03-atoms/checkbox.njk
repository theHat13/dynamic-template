{#
=========================
        CHECKBOX         
=========================
Component that renders checkbox inputs with consistent styling
#}

{% from "03-atoms/box.njk" import renderSingleBox, boxComponent %}

{% macro renderCheckbox(options) %}
  {# Initialize default values for styling classes #}
  {% set globalStyle = options.datas.globalStyle | default('') %}
  {% set fieldsetClasses = options.datas.fieldsetClasses | default('checkbox-group') %}
  {% set legendClasses = options.datas.legendClasses | default('font-medium text-gray-700 mb-3') %}
  {% set groupContainerClasses = options.datas.groupContainerClasses | default('space-y-2') %}
  
  {# Check if rendering as a group or individual checkbox #}
  {% if options.group %}
    <fieldset class="{{ fieldsetClasses }}">
      {% if options.groupLabel %}
        <legend class="{{ legendClasses }} {% if options.groupSrOnly %}sr-only{% endif %}">
          {{ options.groupLabel }}
        </legend>
      {% endif %}
      
      <div class="{{ groupContainerClasses }}">
        {% for checkbox in options.datas.checkboxes %}
          {{ renderSingleCheckbox(checkbox, options.datas) }}
        {% endfor %}
      </div>
    </fieldset>
  {% else %}
    {# Initialize checkboxData as null before searching #}
    {% set checkboxData = null %}
    
    {# Find the checkbox matching the requested ID in the data collection #}
    {% for checkbox in options.datas.checkboxes %}
      {% if checkbox.id == options.id %}
        {% set checkboxData = checkbox %}
      {% endif %}
    {% endfor %}
    
    {# Render checkbox if data was found, otherwise show error #}
    {% if checkboxData %}
      {{ renderSingleCheckbox(checkboxData, options.datas) }}
    {% else %}
      <span class="{{ options.datas.errorClasses | default('text-red-500') }}">Checkbox not found: {{ options.id }}</span>
    {% endif %}
  {% endif %}
{% endmacro %}

{% macro renderSingleCheckbox(checkbox, datas) %}
  {# Initialize style classes for the checkbox and its components #}
  {% set labelClasses = datas.labelClasses | default('flex cursor-pointer items-start gap-4') %}
  {% set labelTextClasses = datas.labelTextClasses | default('font-medium text-gray-900') %}
  {% set descriptionClasses = datas.descriptionClasses | default('text-sm text-gray-500') %}
  
  {# Create box data for the checkbox #}
  {% set boxData = {
    "id": checkbox.id,
    "value": checkbox.value,
    "checked": checkbox.checked,
    "disabled": checkbox.disabled,
    "ariaLabel": checkbox.ariaLabel
  } %}
  
  <label for="{{ checkbox.id }}" class="{{ labelClasses }}">
    {# Use renderSingleBox from box.njk to render the actual checkbox #}
    {{ renderSingleBox(boxData, datas) }}
    
    <div>
      <strong class="{{ labelTextClasses }}">
        {{ checkbox.label }}
      </strong>
      {% if checkbox.description %}
        <p class="{{ descriptionClasses }}">{{ checkbox.description }}</p>
      {% endif %}
    </div>
  </label>
{% endmacro %}

{#
============================
Summon HAT Components Wisely
============================

1. Import the macro at the top of your page
{% from "03-atoms/checkbox.njk" import renderCheckbox %}

2. Call a specific checkbox by its name
{{ renderCheckbox({ id: "option1", datas: atoms.checkboxes }) }}

3. Adding a new checkbox to checkboxes.json
{
  "checkboxes": [
    {
      "id": "unique_id",
      "label": "Checkbox Label",
      "value": "submission_value",
      "checked": true,
      "disabled": false,
      "description": "Additional details about the option",
      "ariaLabel": "Accessible label for screen readers"
    }
  ]
}

May your bugs be forever exiled to the shadow realm. üßô‚Äç‚ôÇÔ∏è‚ú®
#}